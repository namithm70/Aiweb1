(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[976],{3976:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/documents",function(){return t(8814)}])},8814:function(e,s,t){"use strict";t.r(s);var a=t(5893),l=t(7294),c=t(1163),r=t(2002),n=t(6781),i=t(6805),d=t(1429),x=t(6162),m=t(3431),o=t(4931),h=t(1236),u=t(9711),j=t(3903),N=t(2450),p=t(2637);s.default=()=>{let{user:e,loading:s}=(0,n.a)(),{documents:t,loading:g,error:f,uploadDocument:y,deleteDocument:v,clearError:w}=(0,i.s)(),b=(0,c.useRouter)(),[_,k]=(0,l.useState)({}),[Z,D]=(0,l.useState)(!1);(0,l.useEffect)(()=>{s||e||b.push("/login")},[e,s,b]);let E=async e=>{if(0!==e.length){for(let s of(D(!0),w(),e))try{await y(s,e=>{k(t=>({...t,[s.name]:e}))})}catch(e){console.error("Upload failed:",e)}finally{k(e=>{let t={...e};return delete t[s.name],t})}D(!1)}},{getRootProps:P,getInputProps:F,isDragActive:C}=(0,r.uI)({onDrop:E,accept:{"application/pdf":[".pdf"]},maxFiles:5,maxSize:104857600,disabled:Z}),O=async e=>{if(confirm('Are you sure you want to delete "'.concat(e.name,'"?')))try{await v(e.id)}catch(e){console.error("Delete failed:",e)}},S=e=>{switch(e){case"ready":return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-green-500"});case"processing":return(0,a.jsx)(x.Z,{className:"h-5 w-5 text-yellow-500 animate-pulse"});case"failed":return(0,a.jsx)(m.Z,{className:"h-5 w-5 text-red-500"});default:return(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"})}},U=e=>{let s="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(e){case"ready":return"".concat(s," bg-green-100 text-green-800");case"processing":return"".concat(s," bg-yellow-100 text-yellow-800");case"failed":return"".concat(s," bg-red-100 text-red-800");default:return"".concat(s," bg-gray-100 text-gray-800")}};return s?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):e?(0,a.jsx)(p.Z,{children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Upload and manage your PDF documents for analysis."})]}),(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload Documents"}),(0,a.jsxs)("div",{...P(),className:"upload-area ".concat(C?"active":""," ").concat(Z?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:[(0,a.jsx)("input",{...F()}),(0,a.jsx)(h.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("div",{className:"mt-4",children:C?(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Drop the PDF files here..."}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium text-primary-600",children:"Click to upload"})," or drag and drop"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF files only, up to 100MB each"})]})})]}),Object.keys(_).length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:Object.entries(_).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:s}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[t,"%"]})]}),(0,a.jsx)("div",{className:"mt-1 w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(t,"%")}})})]})]},s)})})]}),f&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 text-red-400"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm text-red-800",children:f}),(0,a.jsx)("button",{onClick:w,className:"mt-2 text-sm text-red-600 hover:text-red-500 underline",children:"Dismiss"})]})]})}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Your Documents"})}),g?(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)("div",{className:"spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading documents..."})]}):t.length>0?(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:t.map(e=>(0,a.jsx)("li",{className:"px-6 py-4 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0 flex-1",children:[S(e.status),(0,a.jsxs)("div",{className:"ml-4 min-w-0 flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,a.jsx)("span",{className:U(e.status),children:e.status})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(0,N.sS)(e.size)}),e.page_count&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.page_count," pages"]}),e.chunk_count&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.chunk_count," chunks"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(0,N.p6)(e.updated_at)})]}),e.error&&(0,a.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:["Error: ",e.error]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2 ml-4",children:(0,a.jsx)("button",{onClick:()=>O(e),className:"p-2 text-gray-400 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-md",title:"Delete document",children:(0,a.jsx)(j.Z,{className:"h-4 w-4"})})})]})},e.id))})}):(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)(o.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No documents"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Upload your first PDF document to get started."})]})]}),t.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-3",children:[(0,a.jsx)("div",{className:"card p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(d.Z,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Ready"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(e=>"ready"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"card p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(x.Z,{className:"h-6 w-6 text-yellow-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Processing"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(e=>"processing"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"card p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(m.Z,{className:"h-6 w-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Failed"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(e=>"failed"===e.status).length})]})]})})]})]})}):null}}},function(e){e.O(0,[424,247,175,888,774,179],function(){return e(e.s=3976)}),_N_E=e.O()}]);